{"version":3,"file":"user.js","sources":["stores/user.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\n\r\nexport const useUserStore = defineStore('user', {\r\n\tstate: () => ({\r\n\t\tuserInfo: null\r\n\t}),\r\n\t\r\n\tactions: {\r\n\t\tsetUserInfo(userInfo) {\r\n\t\t\tthis.userInfo = userInfo\r\n\t\t\t// 保存到本地存储\r\n\t\t\tuni.setStorageSync('userInfo', userInfo)\r\n\t\t},\r\n\t\t\r\n\t\tclearUserInfo() {\r\n\t\t\tconsole.log('清除用户信息')\r\n\t\t\tthis.userInfo = null\r\n\t\t\tuni.removeStorageSync('userInfo')\r\n\t\t},\r\n\t\t\r\n\t\t// 退出登录\r\n\t\tlogout() {\r\n\t\t\tthis.clearUserInfo()\r\n\t\t\t// 直接跳转到登录页\r\n\t\t\tuni.reLaunch({\r\n\t\t\t\turl: '/pages/login/index'\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// 初始化时从本地存储加载用户信息\r\n\t\tinitUserInfo() {\r\n\t\t\ttry {\r\n\t\t\t\tconst userInfo = uni.getStorageSync('userInfo')\r\n\t\t\t\tif (userInfo) {\r\n\t\t\t\t\tthis.userInfo = userInfo\r\n\t\t\t\t\tconsole.log('已加载用户信息:', userInfo)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log('未找到用户信息')\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error('读取用户信息失败:', e)\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\tgetters: {\r\n\t\tisLoggedIn: (state) => {\r\n\t\t\tconst isLogin = !!state.userInfo && !!state.userInfo.token\r\n\t\t\tconsole.log('登录状态:', isLogin)\r\n\t\t\treturn isLogin\r\n\t\t}\r\n\t}\r\n}) "],"names":["defineStore","uni"],"mappings":";;AAEY,MAAC,eAAeA,cAAW,YAAC,QAAQ;AAAA,EAC/C,OAAO,OAAO;AAAA,IACb,UAAU;AAAA,EACZ;AAAA,EAEC,SAAS;AAAA,IACR,YAAY,UAAU;AACrB,WAAK,WAAW;AAEhBC,0BAAI,eAAe,YAAY,QAAQ;AAAA,IACvC;AAAA,IAED,gBAAgB;AACfA,oBAAAA,MAAY,MAAA,OAAA,wBAAA,QAAQ;AACpB,WAAK,WAAW;AAChBA,oBAAG,MAAC,kBAAkB,UAAU;AAAA,IAChC;AAAA;AAAA,IAGD,SAAS;AACR,WAAK,cAAe;AAEpBA,oBAAAA,MAAI,SAAS;AAAA,QACZ,KAAK;AAAA,MACT,CAAI;AAAA,IACD;AAAA;AAAA,IAGD,eAAe;AACd,UAAI;AACH,cAAM,WAAWA,cAAAA,MAAI,eAAe,UAAU;AAC9C,YAAI,UAAU;AACb,eAAK,WAAW;AAChBA,wBAAAA,MAAA,MAAA,OAAA,wBAAY,YAAY,QAAQ;AAAA,QACrC,OAAW;AACNA,wBAAAA,2CAAY,SAAS;AAAA,QACrB;AAAA,MACD,SAAQ,GAAG;AACXA,sBAAAA,6CAAc,aAAa,CAAC;AAAA,MAC5B;AAAA,IACD;AAAA,EACD;AAAA,EAED,SAAS;AAAA,IACR,YAAY,CAAC,UAAU;AACtB,YAAM,UAAU,CAAC,CAAC,MAAM,YAAY,CAAC,CAAC,MAAM,SAAS;AACrDA,oBAAAA,MAAY,MAAA,OAAA,wBAAA,SAAS,OAAO;AAC5B,aAAO;AAAA,IACP;AAAA,EACD;AACF,CAAC;;"}